  <domain>-<app>-<version>:
    container_name: <domain>-<app>-<version>
    image: webdevops/php-nginx-dev:<php_version>-alpine
    user: "<user>:<group>"
    working_dir: /app
    ports:
      - <port>:80
    volumes:
      - ~/.ssh:/home/application/.ssh
      - ~/.ssh:/root/.ssh
      - <dir_code>/<app>-<version>:/app
      - <dir_data>/logs/<app>/<version>/api:/var/log/api
    environment:
      WEB_DOCUMENT_ROOT: /app/public
      WEB_DOCUMENT_INDEX: index.php

      XDEBUG_MODE: debug
      XDEBUG_CLIENT_HOST: '172.17.0.1'
      XDEBUG_CLIENT_PORT: 9000
      XDEBUG_DISCOVER_CLIENT_HOST: 0
      XDEBUG_START_WITH_REQUEST: 'yes'

      DREAMSHAPER_REDIS_DSN: 'redis://<domain>-redis:6379/messages'

      DREAMSHAPER_LOCAL_DATABASE_DRIVER: pdo_mysql
      DREAMSHAPER_LOCAL_DATABASE_SCHEMA: <local_database>
      DREAMSHAPER_LOCAL_DATABASE_HOST: '<domain>-mysql'
      DREAMSHAPER_LOCAL_DATABASE_PORT: 3306
      DREAMSHAPER_LOCAL_DATABASE_USER: root
      DREAMSHAPER_LOCAL_DATABASE_PASSWORD: root
      DREAMSHAPER_LOCAL_DATABASE_VERSION: 'mariadb-10.4.13'

      DREAMSHAPER_LEGACY_DATABASE_DRIVER: pdo_mysql
      DREAMSHAPER_LEGACY_DATABASE_SCHEMA: <legacy_database>
      DREAMSHAPER_LEGACY_DATABASE_HOST: '<domain>-mysql'
      DREAMSHAPER_LEGACY_DATABASE_PORT: 3306
      DREAMSHAPER_LEGACY_DATABASE_USER: root
      DREAMSHAPER_LEGACY_DATABASE_PASSWORD: root
      DREAMSHAPER_LEGACY_DATABASE_VERSION: 'mariadb-10.4.13'
    depends_on:
      - <domain>-mysql
      - <domain>-auth-api-<auth_api_version>
      - <domain>-org-api-<org_api_version>
      - <domain>-project-api-<project_api_version>
      - <domain>-feedback-api-<feedback_api_version>
